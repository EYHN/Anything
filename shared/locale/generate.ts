import fs from 'fs';
import path from 'path';
import { MetadataSchema } from '../metadata/generated/schema';
import messages from './messages.json';
import MimetypeSchema from '../mimetype/mimetype.json';

function generatePOFile() {
  const msgIds = [
    ...messages,
    ...Object.keys(MetadataSchema).flatMap((id) => [`Metadata.${id}`, `Metadata.${id}.Value`]),
    ...MimetypeSchema.map((mimetype) => `MimeType:${mimetype.mime}`),
  ];

  return `# This file is automatically generated by @anything/shared, please do not modify this file.
msgid ""
msgstr ""
"POT-Creation-Date: 2021-06-05 00:51+0800\\n"
"Mime-Version: 1.0\\n"
"Content-Type: text/plain; charset=utf-8\\n"
"Content-Transfer-Encoding: 8bit\\n"
"Language: \\n"

${msgIds.map((msgId) => `msgid "${msgId}"\nmsgstr ""`).join('\n\n')}
`;
}

fs.writeFileSync(path.join(__dirname, './generated/messages.pot'), generatePOFile());
